module.exports = [
"[externals]/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-route-turbo.runtime.dev.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js"));

module.exports = mod;
}),
"[externals]/next/dist/compiled/@opentelemetry/api [external] (next/dist/compiled/@opentelemetry/api, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/@opentelemetry/api", () => require("next/dist/compiled/@opentelemetry/api"));

module.exports = mod;
}),
"[externals]/next/dist/compiled/next-server/app-page-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-page-turbo.runtime.dev.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/work-unit-async-storage.external.js [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/work-unit-async-storage.external.js", () => require("next/dist/server/app-render/work-unit-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/work-async-storage.external.js [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/work-async-storage.external.js", () => require("next/dist/server/app-render/work-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/shared/lib/no-fallback-error.external.js [external] (next/dist/shared/lib/no-fallback-error.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/shared/lib/no-fallback-error.external.js", () => require("next/dist/shared/lib/no-fallback-error.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/after-task-async-storage.external.js [external] (next/dist/server/app-render/after-task-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/after-task-async-storage.external.js", () => require("next/dist/server/app-render/after-task-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/node:stream [external] (node:stream, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:stream", () => require("node:stream"));

module.exports = mod;
}),
"[externals]/buffer [external] (buffer, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("buffer", () => require("buffer"));

module.exports = mod;
}),
"[externals]/string_decoder [external] (string_decoder, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("string_decoder", () => require("string_decoder"));

module.exports = mod;
}),
"[externals]/stream [external] (stream, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("stream", () => require("stream"));

module.exports = mod;
}),
"[externals]/node:assert [external] (node:assert, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:assert", () => require("node:assert"));

module.exports = mod;
}),
"[externals]/node:net [external] (node:net, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:net", () => require("node:net"));

module.exports = mod;
}),
"[externals]/node:http [external] (node:http, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:http", () => require("node:http"));

module.exports = mod;
}),
"[externals]/node:querystring [external] (node:querystring, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:querystring", () => require("node:querystring"));

module.exports = mod;
}),
"[externals]/node:events [external] (node:events, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:events", () => require("node:events"));

module.exports = mod;
}),
"[externals]/node:diagnostics_channel [external] (node:diagnostics_channel, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:diagnostics_channel", () => require("node:diagnostics_channel"));

module.exports = mod;
}),
"[externals]/node:util [external] (node:util, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:util", () => require("node:util"));

module.exports = mod;
}),
"[externals]/node:tls [external] (node:tls, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:tls", () => require("node:tls"));

module.exports = mod;
}),
"[externals]/node:buffer [external] (node:buffer, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:buffer", () => require("node:buffer"));

module.exports = mod;
}),
"[externals]/node:zlib [external] (node:zlib, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:zlib", () => require("node:zlib"));

module.exports = mod;
}),
"[externals]/node:perf_hooks [external] (node:perf_hooks, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:perf_hooks", () => require("node:perf_hooks"));

module.exports = mod;
}),
"[externals]/node:util/types [external] (node:util/types, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:util/types", () => require("node:util/types"));

module.exports = mod;
}),
"[externals]/node:crypto [external] (node:crypto, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:crypto", () => require("node:crypto"));

module.exports = mod;
}),
"[externals]/node:worker_threads [external] (node:worker_threads, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:worker_threads", () => require("node:worker_threads"));

module.exports = mod;
}),
"[externals]/node:http2 [external] (node:http2, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:http2", () => require("node:http2"));

module.exports = mod;
}),
"[externals]/node:async_hooks [external] (node:async_hooks, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:async_hooks", () => require("node:async_hooks"));

module.exports = mod;
}),
"[externals]/node:console [external] (node:console, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:console", () => require("node:console"));

module.exports = mod;
}),
"[externals]/node:fs/promises [external] (node:fs/promises, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:fs/promises", () => require("node:fs/promises"));

module.exports = mod;
}),
"[externals]/node:path [external] (node:path, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:path", () => require("node:path"));

module.exports = mod;
}),
"[externals]/node:timers [external] (node:timers, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:timers", () => require("node:timers"));

module.exports = mod;
}),
"[externals]/node:dns [external] (node:dns, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:dns", () => require("node:dns"));

module.exports = mod;
}),
"[project]/src/lib/aiClient.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "analyzeWebsite",
    ()=>analyzeWebsite,
    "generateBannerImage",
    ()=>generateBannerImage,
    "generateHtmlLayout",
    ()=>generateHtmlLayout
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$openai$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/openai/index.mjs [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$openai$2f$client$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__OpenAI__as__default$3e$__ = __turbopack_context__.i("[project]/node_modules/openai/client.mjs [app-route] (ecmascript) <export OpenAI as default>");
;
// Initialize OpenAI client (will use env vars)
const openai = process.env.OPENAI_API_KEY ? new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$openai$2f$client$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__OpenAI__as__default$3e$__["default"]({
    apiKey: process.env.OPENAI_API_KEY
}) : null;
// Check if API key is configured
if (!process.env.OPENAI_API_KEY) {
    console.warn("⚠️  OPENAI_API_KEY not found in environment variables. AI features will use mock data.");
}
async function analyzeWebsite(content) {
    const prompt = `You are an expert marketing strategist and brand analyst. Carefully analyze this company website content in detail. Extract ALL key information including company name, what they do, their main services/products, and brand identity.

Website content (read EVERY section carefully - company info, hero, about, sections by H2, paragraphs, key phrases, navigation, list items):
${content.substring(0, 16000)}

Your task - extract in DETAIL:
1. COMPANY NAME: From title, OG title, logo alt, or main H1. Be exact.
2. WHAT THE COMPANY DOES: From meta description, hero/intro, about section, and first paragraphs. Write 2-3 clear sentences covering industry, main business, and key value proposition.
3. MAIN SERVICES/PRODUCTS: From navigation, list items, and section headings. List 4-6 specific offerings (not generic "Services").
4. SUMMARY: A rich 4-6 sentence overview: who they are, what they do, who they serve, key differentiators or numbers (e.g. "500+ engineers"), and tone. Use concrete details from the content.
5. TONE & AUDIENCE: Infer from wording and sections. Be specific (e.g. "B2B enterprises in Asia" not just "businesses").
6. BANNER CONCEPTS: Headlines must include company name; subheadlines must reflect real services/value from the content.

Provide a JSON response with:
- companyName: Exact company name
- companyDescription: 2-3 sentences (what they do, for whom, key strength)
- mainServices: Array of 4-6 specific services/products from the site
- summary: Detailed 4-6 sentence brand overview (use numbers, key phrases, differentiators from content)
- tone: Brand voice (one or two words)
- audience: Specific target (e.g. "B2B enterprises", "SMB in Vietnam")
- conceptSuggestions: Array of 2-3 concepts with headline (company name + value), subheadline (specific services/value), cta, styleGuide (colors, font, mood)
- recommendedPrompt: Detailed banner prompt with company name, real services, and style

Return ONLY valid JSON, no markdown formatting.`;
    // Mock mode if no API key: parse content in detail for rich analysis
    if (!openai) {
        console.log("Using mock analysis (no API key) - extracting from website content");
        const companyNameMatch = content.match(/Company Name \(from title\):\s*(.+?)(?:\n|$)/i) || content.match(/Page Title:\s*(.+?)(?:\s*[-|]\s|$)/i) || content.match(/OG Title:\s*(.+?)(?:\n|$)/i);
        const companyName = companyNameMatch ? companyNameMatch[1].trim().replace(/\s*[-|].*$/, "").substring(0, 80) : "Company";
        const metaDesc = content.match(/Meta Description:\s*(.+?)(?:\n\n|\n===|$)/is);
        const ogDesc = content.match(/OG Description:\s*(.+?)(?:\n\n|\n===|$)/is);
        const companyDescription = (metaDesc?.[1]?.trim() || ogDesc?.[1]?.trim() || "").substring(0, 220) || "Professional services and solutions for your business.";
        const h1Match = content.match(/H1:\s*(.+?)(?:\n\n|\n===|$)/i);
        const h1Text = h1Match ? h1Match[1].trim().split("|").map((s)=>s.trim()).filter(Boolean)[0] : "";
        const heroMatch = content.match(/HERO \/ INTRO TEXT ===\s*\n([\s\S]+?)(?:\n\n===|$)/i);
        const heroText = heroMatch ? heroMatch[1].trim().substring(0, 300) : "";
        const sectionsMatch = content.match(/CONTENT BY SECTIONS \(H2\) ===\s*\n([\s\S]+?)(?:\n\n===|$)/i);
        const sectionsText = sectionsMatch ? sectionsMatch[1].trim().substring(0, 600) : "";
        const navMatch = content.match(/NAVIGATION \/ MENU \/ SERVICES ===\s*\n([\s\S]+?)(?:\n\n===|$)/i);
        const navStr = navMatch ? navMatch[1].trim() : "";
        const mainServices = navStr ? navStr.split("|").map((s)=>s.trim()).filter((s)=>s.length > 2 && s.length < 45).slice(0, 6) : [];
        const listMatch = content.match(/LIST ITEMS \/ FEATURES ===\s*\n-?\s*([\s\S]+?)(?:\n\n===|$)/i);
        const listStr = listMatch ? listMatch[1].trim() : "";
        const listItems = listStr.split(/\n-/).map((s)=>s.trim()).filter((s)=>s.length > 5 && s.length < 80).slice(0, 8);
        if (listItems.length && mainServices.length < 3) mainServices.push(...listItems.slice(0, 4));
        const services = mainServices.length ? mainServices.slice(0, 6) : h1Text ? [
            h1Text
        ] : [
            "Services",
            "Solutions",
            "Consulting"
        ];
        const paragraphsMatch = content.match(/ALL PARAGRAPHS \(main body\) ===\s*\n([\s\S]+?)(?:\n\n===|$)/i);
        const paraText = paragraphsMatch ? paragraphsMatch[1].trim().substring(0, 500) : "";
        const summaryParts = [
            companyName,
            companyDescription,
            heroText || paraText,
            sectionsText
        ].filter(Boolean);
        const summary = summaryParts.join(" ").substring(0, 520) + (summaryParts.join(" ").length > 520 ? "…" : "");
        return {
            companyName: companyName || "Company",
            companyDescription: companyDescription || "Professional solutions",
            mainServices: services,
            summary: summary || "Company information extracted from website.",
            tone: "professional",
            audience: "Businesses and clients seeking quality services",
            conceptSuggestions: [
                {
                    headline: `${companyName} — ${h1Text || "Solutions"}`,
                    subheadline: (companyDescription + (heroText ? " " + heroText.substring(0, 80) : "")).substring(0, 120),
                    cta: "Contact Us",
                    styleGuide: {
                        colors: [
                            "#1e3a5f",
                            "#2563eb",
                            "#0ea5e9"
                        ],
                        font: "Inter",
                        mood: "modern, confident, professional"
                    }
                },
                {
                    headline: `${companyName}`,
                    subheadline: (h1Text || companyDescription).substring(0, 120),
                    cta: "Learn More",
                    styleGuide: {
                        colors: [
                            "#0f766e",
                            "#0d9488",
                            "#14b8a6"
                        ],
                        font: "Inter",
                        mood: "trustworthy, innovative"
                    }
                }
            ],
            recommendedPrompt: `Professional marketing banner for ${companyName}. Display company name prominently. Include: ${companyDescription.substring(0, 100)}. Services: ${services.slice(0, 4).join(", ")}. Modern, clean design.`
        };
    }
    try {
        const completion = await openai.chat.completions.create({
            model: "gpt-4o-mini",
            messages: [
                {
                    role: "system",
                    content: "You are a marketing strategist. Return only valid JSON, no markdown or code blocks."
                },
                {
                    role: "user",
                    content: prompt
                }
            ],
            response_format: {
                type: "json_object"
            },
            temperature: 0.7
        });
        const result = JSON.parse(completion.choices[0]?.message?.content || "{}");
        return result;
    } catch (error) {
        console.error("AI analysis error:", error);
        // Return fallback data
        return {
            summary: "Brand analysis completed. Ready to generate banners.",
            tone: "professional",
            audience: "General audience",
            conceptSuggestions: [
                {
                    headline: "Transform Your Business",
                    subheadline: "Discover innovative solutions",
                    cta: "Get Started",
                    styleGuide: {
                        colors: [
                            "#6366f1",
                            "#8b5cf6",
                            "#06b6d4"
                        ],
                        font: "Inter",
                        mood: "modern, confident"
                    }
                }
            ],
            recommendedPrompt: "Modern marketing banner with gradient background, professional typography, clean layout"
        };
    }
}
async function generateBannerImage(prompt) {
    // Mock mode if no API key
    if (!openai) {
        console.log("Using mock image (no API key)");
        // Return a placeholder image URL
        return {
            imageUrl: "https://via.placeholder.com/1200x400/6366f1/ffffff?text=Mock+Banner+Preview%0A(Add+OPENAI_API_KEY+to+generate+real+images)"
        };
    }
    try {
        console.log("Generating image with prompt:", prompt);
        const response = await openai.images.generate({
            model: "dall-e-3",
            prompt: `Marketing banner design: ${prompt}. Professional, high-quality, suitable for web advertising.`,
            size: "1024x1792",
            quality: "standard",
            n: 1
        });
        console.log("DALL-E response:", response);
        const imageUrl = response.data[0]?.url || "";
        console.log("Generated image URL:", imageUrl);
        if (!imageUrl) {
            throw new Error("No image URL returned from DALL-E");
        }
        return {
            imageUrl
        };
    } catch (error) {
        console.error("Image generation error:", error);
        if (error instanceof Error) {
            throw new Error(`Failed to generate image: ${error.message}`);
        }
        throw new Error("Failed to generate image");
    }
}
/**
 * Parse color hints from user prompt (e.g. "vàng đen", "yellow black", "đỏ")
 */ function parseColorsFromPrompt(prompt) {
    const p = prompt.toLowerCase();
    const colorMap = {
        "vàng đen": [
            "#1a1a1a",
            "#2d2d2d",
            "#FACC15"
        ],
        "yellow black": [
            "#1a1a1a",
            "#2d2d2d",
            "#FACC15"
        ],
        "vàng và đen": [
            "#1a1a1a",
            "#FACC15"
        ],
        "đen vàng": [
            "#1a1a1a",
            "#262626",
            "#FACC15"
        ],
        "black yellow": [
            "#1a1a1a",
            "#262626",
            "#FACC15"
        ],
        "đỏ": [
            "#dc2626",
            "#b91c1c",
            "#f87171"
        ],
        "red": [
            "#dc2626",
            "#b91c1c",
            "#f87171"
        ],
        "xanh dương": [
            "#2563eb",
            "#1d4ed8",
            "#3b82f6"
        ],
        "blue": [
            "#2563eb",
            "#1d4ed8",
            "#3b82f6"
        ],
        "xanh lá": [
            "#16a34a",
            "#15803d",
            "#22c55e"
        ],
        "green": [
            "#16a34a",
            "#15803d",
            "#22c55e"
        ],
        "tím": [
            "#7c3aed",
            "#6d28d9",
            "#8b5cf6"
        ],
        "purple": [
            "#7c3aed",
            "#6d28d9",
            "#8b5cf6"
        ],
        "cam": [
            "#ea580c",
            "#c2410c",
            "#f97316"
        ],
        "orange": [
            "#ea580c",
            "#c2410c",
            "#f97316"
        ]
    };
    for (const [key, colors] of Object.entries(colorMap)){
        if (p.includes(key)) return colors;
    }
    if (/\b(vàng|yellow)\b/.test(p) && /\b(đen|black)\b/.test(p)) return [
        "#1a1a1a",
        "#2d2d2d",
        "#FACC15"
    ];
    return null;
}
async function generateHtmlLayout(prompt, concept, companyInfo, userModification) {
    // Mock mode if no API key
    if (!openai) {
        console.log("Using mock HTML/CSS (no API key)");
        const companyName = companyInfo?.companyName || concept?.headline.split(/[-—]/)[0]?.trim() || "Company Name";
        const headline = concept?.headline?.replace(companyName + " - ", "")?.replace(companyName + " — ", "")?.replace(companyName + " ", "") || "Solutions & Services";
        const subheadline = concept?.subheadline || companyInfo?.companyDescription || "Discover innovative solutions for your business.";
        const servicesList = companyInfo?.mainServices?.slice(0, 4) || [];
        const cta = concept?.cta || "Get Started";
        // Apply user's color/modification from prompt (e.g. "vàng đen", "yellow black")
        const promptColors = parseColorsFromPrompt(prompt);
        const colors = promptColors || concept?.styleGuide.colors || [
            "#1e3a5f",
            "#2563eb",
            "#0ea5e9"
        ];
        const servicesHtml = servicesList.length ? `<ul class="banner-services-list">${servicesList.map((s)=>`<li><span class="banner-service-pill">${s}</span></li>`).join("")}</ul>` : "";
        return {
            html: `
        <div class="banner">
          <div class="banner-bg-pattern"></div>
          <div class="banner-inner">
            <div class="banner-main">
              <div class="banner-badge">Professional</div>
              <h1 class="banner-company-name">${companyName}</h1>
              <p class="banner-tagline">${headline}</p>
              <p class="banner-description">${subheadline}</p>
              ${servicesHtml}
              <div class="banner-cta-wrap">
                <button class="banner-cta primary">${cta}</button>
                <span class="banner-cta-secondary">Learn more</span>
              </div>
            </div>
            <div class="banner-side">
              <div class="banner-card">
                <div class="banner-card-value">Trusted</div>
                <div class="banner-card-label">Partner</div>
              </div>
              <div class="banner-card">
                <div class="banner-card-value">Quality</div>
                <div class="banner-card-label">Focus</div>
              </div>
            </div>
          </div>
        </div>
      `,
            css: `
        .banner {
          width: 1200px;
          min-height: 480px;
          background: linear-gradient(135deg, ${colors[0]} 0%, ${colors[1] || colors[0]} 50%, ${colors[2] || colors[1] || colors[0]} 100%);
          border-radius: 16px;
          box-shadow: 0 25px 80px rgba(0,0,0,0.25), 0 0 0 1px rgba(255,255,255,0.08);
          position: relative;
          overflow: hidden;
          font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }
        .banner-bg-pattern {
          position: absolute;
          inset: 0;
          background: radial-gradient(ellipse 80% 50% at 100% 50%, rgba(255,255,255,0.12) 0%, transparent 50%),
                      linear-gradient(180deg, transparent 0%, rgba(0,0,0,0.06) 100%);
          pointer-events: none;
        }
        .banner-inner {
          position: relative;
          z-index: 1;
          display: flex;
          align-items: stretch;
          justify-content: space-between;
          padding: 48px 56px;
          min-height: 480px;
        }
        .banner-main {
          flex: 1;
          max-width: 720px;
          color: #fff;
        }
        .banner-badge {
          display: inline-block;
          font-size: 11px;
          font-weight: 600;
          letter-spacing: 0.12em;
          text-transform: uppercase;
          color: rgba(255,255,255,0.9);
          background: rgba(255,255,255,0.18);
          padding: 6px 14px;
          border-radius: 100px;
          margin-bottom: 20px;
        }
        .banner-company-name {
          font-size: 42px;
          font-weight: 700;
          letter-spacing: -0.02em;
          line-height: 1.15;
          margin: 0 0 12px 0;
          text-shadow: 0 2px 20px rgba(0,0,0,0.2);
        }
        .banner-tagline {
          font-size: 22px;
          font-weight: 600;
          opacity: 0.95;
          margin: 0 0 16px 0;
          line-height: 1.35;
        }
        .banner-description {
          font-size: 16px;
          line-height: 1.6;
          opacity: 0.9;
          margin: 0 0 28px 0;
          max-width: 540px;
        }
        .banner-services-list {
          list-style: none;
          margin: 0 0 32px 0;
          padding: 0;
          display: flex;
          flex-wrap: wrap;
          gap: 10px;
        }
        .banner-services-list li { margin: 0; padding: 0; }
        .banner-service-pill {
          display: inline-block;
          font-size: 13px;
          font-weight: 500;
          color: rgba(255,255,255,0.95);
          background: rgba(255,255,255,0.2);
          padding: 8px 16px;
          border-radius: 8px;
          border: 1px solid rgba(255,255,255,0.25);
        }
        .banner-cta-wrap {
          display: flex;
          align-items: center;
          gap: 20px;
        }
        .banner-cta {
          border: none;
          padding: 16px 32px;
          font-size: 16px;
          font-weight: 600;
          border-radius: 10px;
          cursor: pointer;
          transition: transform 0.15s, box-shadow 0.2s;
        }
        .banner-cta.primary {
          background: #fff;
          color: ${colors[0]};
          box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }
        .banner-cta.primary:hover {
          transform: translateY(-2px);
          box-shadow: 0 8px 28px rgba(0,0,0,0.25);
        }
        .banner-cta-secondary {
          font-size: 14px;
          font-weight: 500;
          color: rgba(255,255,255,0.9);
          text-decoration: underline;
          text-underline-offset: 3px;
          cursor: pointer;
        }
        .banner-side {
          display: flex;
          flex-direction: column;
          justify-content: center;
          gap: 16px;
          margin-left: 40px;
        }
        .banner-card {
          background: rgba(255,255,255,0.15);
          backdrop-filter: blur(8px);
          border: 1px solid rgba(255,255,255,0.25);
          border-radius: 12px;
          padding: 20px 28px;
          min-width: 140px;
          text-align: center;
        }
        .banner-card-value {
          font-size: 20px;
          font-weight: 700;
          color: #fff;
          margin-bottom: 4px;
        }
        .banner-card-label {
          font-size: 12px;
          font-weight: 500;
          color: rgba(255,255,255,0.85);
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }
      `
        };
    }
    const companyInfoText = companyInfo ? `\nCompany Name: ${companyInfo.companyName}\nCompany Description: ${companyInfo.companyDescription}\nMain Services: ${companyInfo.mainServices?.join(", ")}` : "";
    const userRequestBlock = userModification && userModification.length > 0 ? `\n\n*** CRITICAL - USER MODIFICATION REQUEST (you MUST apply this): ***\n"${userModification}"\n*** Apply the above changes (colors, style, layout) to the banner. Then follow the requirements below. ***\n\n` : "";
    const layoutPrompt = `${userRequestBlock}You are an expert web designer. Create a RICH, PROFESSIONAL marketing banner (HTML + CSS) that looks like a high-end SaaS/corporate landing hero.

REQUIRED ELEMENTS (include all):
1. COMPANY NAME - large, bold (e.g. 38-44px), prominent at top
2. SHORT TAGLINE or HEADLINE - under company name (e.g. 20-24px)
3. DESCRIPTION - 1-2 sentences explaining what the company does (e.g. 15-17px, max-width for readability)
4. SERVICES / KEY OFFERINGS - display as 3-5 pills or badges (e.g. "Software Development", "Consulting") in a row
5. PRIMARY CTA BUTTON - main action (e.g. "Contact Us", "Get Started")
6. OPTIONAL: small badge at top (e.g. "Professional" or "Trusted Partner") and/or 1-2 small value cards (e.g. "Trusted Partner", "Quality Focus") on the right side

Design requirements:
- Size: 1200px width, min-height 480px (not 400px)
- Layout: main content left (company name, tagline, description, services, CTA); optional cards or accent on right
- Use gradient background with the provided colors; subtle overlay or pattern is fine
- Professional typography: clear hierarchy, good line-height, text-shadow if needed for readability
- Pills/badges for services: rounded, semi-transparent background, readable
- One primary CTA button (white or contrasting), optional secondary text link
- Rounded corners (12-16px), subtle shadow. No simple one-line layout.

Concept details:
Prompt: ${prompt}
${concept ? `Headline: ${concept.headline}\nSubheadline: ${concept.subheadline}\nCTA: ${concept.cta}\nColors: ${concept.styleGuide.colors.join(", ")}\nMood: ${concept.styleGuide.mood}` : ""}
${companyInfoText}

Return a JSON object with:
- html: Complete HTML (semantic: divs with classes like banner, banner-company-name, banner-tagline, banner-description, banner-services-list or banner-service-pill, banner-cta, etc.)
- css: Full CSS for all classes (gradient, spacing, typography, pills, button, cards). Banner must be 1200px wide, min-height 480px.

The banner must look professional and information-rich: anyone should immediately see company name, what they do, and key services.
Return ONLY valid JSON, no markdown formatting.`;
    try {
        const completion = await openai.chat.completions.create({
            model: "gpt-4o-mini",
            messages: [
                {
                    role: "system",
                    content: "You are a frontend developer. Return only valid JSON with 'html' and 'css' keys."
                },
                {
                    role: "user",
                    content: layoutPrompt
                }
            ],
            response_format: {
                type: "json_object"
            },
            temperature: 0.8
        });
        const result = JSON.parse(completion.choices[0]?.message?.content || "{}");
        return {
            html: result.html || "<div>Banner HTML</div>",
            css: result.css || "div { padding: 20px; }"
        };
    } catch (error) {
        console.error("HTML generation error:", error);
        return {
            html: '<div class="banner"><h1>Banner</h1></div>',
            css: ".banner { padding: 20px; }"
        };
    }
}
}),
"[project]/src/app/api/analyze-url/route.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "POST",
    ()=>POST
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/server.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$cheerio$2f$dist$2f$esm$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/cheerio/dist/esm/index.js [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$cheerio$2f$dist$2f$esm$2f$load$2d$parse$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/cheerio/dist/esm/load-parse.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$aiClient$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/aiClient.ts [app-route] (ecmascript)");
;
;
;
async function POST(request) {
    try {
        const { url } = await request.json();
        if (!url || typeof url !== "string") {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: "URL is required"
            }, {
                status: 400
            });
        }
        // Normalize URL: ensure it has a protocol
        let urlToFetch = url.trim();
        if (!/^https?:\/\//i.test(urlToFetch)) {
            urlToFetch = "https://" + urlToFetch;
        }
        // Validate URL format
        let parsedUrl;
        try {
            parsedUrl = new URL(urlToFetch);
        } catch  {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: "Invalid URL format. Please use a full URL (e.g. https://example.com)"
            }, {
                status: 400
            });
        }
        // Only allow http and https
        if (![
            "http:",
            "https:"
        ].includes(parsedUrl.protocol)) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: "Only HTTP and HTTPS URLs are supported"
            }, {
                status: 400
            });
        }
        // Fetch website content (try https first, then http if needed)
        let html;
        const urlsToTry = [
            parsedUrl.href
        ];
        if (parsedUrl.protocol === "https:") {
            urlsToTry.push(parsedUrl.href.replace(/^https:\/\//i, "http://"));
        }
        let lastError = null;
        for (const fetchUrl of urlsToTry){
            try {
                console.log("Fetching URL:", fetchUrl);
                const controller = new AbortController();
                const timeoutId = setTimeout(()=>controller.abort(), 20000);
                const response = await fetch(fetchUrl, {
                    method: "GET",
                    headers: {
                        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",
                        Accept: "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8",
                        "Accept-Language": "en-US,en;q=0.9,vi;q=0.8",
                        "Cache-Control": "no-cache",
                        "Upgrade-Insecure-Requests": "1"
                    },
                    signal: controller.signal,
                    redirect: "follow",
                    // @ts-expect-error Next.js extends fetch with cache
                    cache: "no-store"
                });
                clearTimeout(timeoutId);
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                const contentType = response.headers.get("content-type") || "";
                if (!contentType.includes("text/html") && !contentType.includes("text/plain")) {
                    console.warn("Content-Type is not HTML:", contentType);
                }
                html = await response.text();
                if (!html || html.length < 100) {
                    throw new Error("Website returned empty or very short content");
                }
                console.log(`Fetched ${html.length} characters of HTML`);
                lastError = null;
                break;
            } catch (error) {
                lastError = error;
                console.warn("Fetch attempt failed for", fetchUrl, lastError.message);
                if (urlsToTry.indexOf(fetchUrl) < urlsToTry.length - 1) {
                    continue; // try next URL
                }
            }
        }
        if (lastError != null || html == null) {
            const err = lastError || new Error("Unknown");
            console.error("Fetch error:", err);
            let userMessage;
            if (err.name === "AbortError" || err.message?.includes("aborted")) {
                userMessage = "Request timeout. The website took too long to respond. Try again or use a different URL.";
            } else if (err.message?.includes("fetch failed")) {
                const cause = err.cause?.message || err.cause?.toString() || "";
                if (cause.includes("certificate") || cause.includes("SSL") || cause.includes("TLS")) {
                    userMessage = "SSL certificate error. Try entering the URL with http:// instead of https:// for this site.";
                } else if (cause.includes("ENOTFOUND") || cause.includes("getaddrinfo")) {
                    userMessage = "Domain not found. Check the URL (e.g. https://example.com) and try again.";
                } else if (cause.includes("ECONNREFUSED") || cause.includes("ECONNRESET")) {
                    userMessage = "Connection refused or reset. The site may be down or blocking requests. Try another URL.";
                } else {
                    userMessage = "Could not connect. Check: (1) URL has https:// or http:// (2) Site opens in your browser (3) Try another company website.";
                }
            } else if (err.message?.includes("timeout") || err.message?.includes("HTTP 5")) {
                userMessage = "Website did not respond in time or returned an error. Try again or another URL.";
            } else {
                userMessage = err.message || "Could not fetch website. Check the URL and try again.";
            }
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: userMessage
            }, {
                status: 500
            });
        }
        // Parse HTML and extract comprehensive content (detailed for rich analysis)
        const $ = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$cheerio$2f$dist$2f$esm$2f$load$2d$parse$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["load"](html);
        // Basic meta
        const title = $("title").text().trim();
        const metaDescription = $('meta[name="description"]').attr("content") || "";
        const metaKeywords = $('meta[name="keywords"]').attr("content") || "";
        const ogTitle = $('meta[property="og:title"]').attr("content") || "";
        const ogDescription = $('meta[property="og:description"]').attr("content") || "";
        const logoAlt = $("img[alt*='logo'], img[alt*='Logo'], .logo img").attr("alt") || "";
        const companyNameFromTitle = title.split(" - ")[0].split(" | ")[0].trim();
        const headings = {
            h1: $("h1").map((_, el)=>$(el).text().trim()).get().slice(0, 8),
            h2: $("h2").map((_, el)=>$(el).text().trim()).get().slice(0, 15),
            h3: $("h3").map((_, el)=>$(el).text().trim()).get().slice(0, 15)
        };
        // More paragraphs and longer text (hero, intro, about sections)
        const allParagraphs = $("p").map((_, el)=>$(el).text().trim()).get().filter((p)=>p.length > 15).slice(0, 35);
        const heroIntro = $(".hero p, .intro p, .banner p, [class*='hero'] p, [class*='intro'] p").map((_, el)=>$(el).text().trim()).get().filter(Boolean).slice(0, 5);
        const aboutSection = $("[class*='about'] p, #about p").map((_, el)=>$(el).text().trim()).get().filter((p)=>p.length > 20).slice(0, 5);
        // Sections by H2: for each H2, take the following text until next H2
        const sectionsByH2 = [];
        $("h2").slice(0, 12).each((_, h2El)=>{
            const h2Text = $(h2El).text().trim();
            const next = $(h2El).nextUntil("h2").map((_, el)=>$(el).text().trim()).get().join(" ").trim();
            if (h2Text && next.length > 30) sectionsByH2.push(`[${h2Text}]: ${next.substring(0, 400)}`);
        });
        const navItems = $("nav a, .menu a, .navigation a, header a").map((_, el)=>$(el).text().trim()).get().filter((item)=>item.length > 1 && item.length < 60).slice(0, 25);
        const listItems = $("li").map((_, el)=>$(el).text().trim()).get().filter((item)=>item.length > 8 && item.length < 250).slice(0, 30);
        const buttons = $("button, .btn, .button, a[class*='button'], a[class*='btn']").map((_, el)=>$(el).text().trim()).get().filter((btn)=>btn.length > 0 && btn.length < 50).slice(0, 12);
        // Strong/bold phrases (often key value props)
        const strongPhrases = $("strong, b").map((_, el)=>$(el).text().trim()).get().filter((s)=>s.length > 3 && s.length < 100).slice(0, 15);
        const content = [
            `=== COMPANY & PAGE INFO ===`,
            `Company Name (from title): ${companyNameFromTitle}`,
            `Logo Alt: ${logoAlt}`,
            `Page Title: ${title}`,
            `Meta Description: ${metaDescription}`,
            `Meta Keywords: ${metaKeywords}`,
            `OG Title: ${ogTitle}`,
            `OG Description: ${ogDescription}`,
            ``,
            `=== HEADINGS STRUCTURE ===`,
            `H1: ${headings.h1.join(" | ")}`,
            `H2: ${headings.h2.join(" | ")}`,
            `H3: ${headings.h3.join(" | ")}`,
            ``,
            `=== HERO / INTRO TEXT ===`,
            heroIntro.join("\n\n"),
            ``,
            `=== ABOUT SECTION ===`,
            aboutSection.join("\n\n"),
            ``,
            `=== CONTENT BY SECTIONS (H2) ===`,
            sectionsByH2.join("\n\n"),
            ``,
            `=== ALL PARAGRAPHS (main body) ===`,
            allParagraphs.join("\n\n"),
            ``,
            `=== KEY PHRASES (bold/strong) ===`,
            strongPhrases.join(" | "),
            ``,
            `=== NAVIGATION / MENU / SERVICES ===`,
            navItems.join(" | "),
            ``,
            `=== LIST ITEMS / FEATURES ===`,
            listItems.join("\n- "),
            ``,
            `=== BUTTONS / CTAs ===`,
            buttons.join(" | ")
        ].filter(Boolean).join("\n\n");
        if (!content.trim() || content.length < 50) {
            console.error("Extracted content too short:", content.substring(0, 200));
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: "Could not extract meaningful content from the website. The page might be empty, require JavaScript to load content, or be blocked."
            }, {
                status: 500
            });
        }
        console.log(`Extracted ${content.length} characters of content`);
        console.log("Content preview:", content.substring(0, 500));
        // Analyze with AI
        let analysis;
        try {
            analysis = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$aiClient$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["analyzeWebsite"])(content);
            console.log("Analysis completed:", {
                companyName: analysis.companyName,
                hasConcepts: analysis.conceptSuggestions?.length > 0
            });
        } catch (error) {
            console.error("AI analysis error:", error);
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: `AI analysis failed: ${error instanceof Error ? error.message : "Unknown error"}`
            }, {
                status: 500
            });
        }
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            url: parsedUrl.toString(),
            analysis
        });
    } catch (error) {
        console.error("Analyze URL error:", error);
        const errorMessage = error instanceof Error ? error.message : "Unknown error";
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            error: `Internal server error: ${errorMessage}`
        }, {
            status: 500
        });
    }
}
}),
];

//# sourceMappingURL=%5Broot-of-the-server%5D__250168e3._.js.map