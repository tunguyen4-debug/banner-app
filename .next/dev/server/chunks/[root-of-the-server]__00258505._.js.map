{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ntq.L-AI-TUNV4/ai-banner-app/src/lib/aiClient.ts"],"sourcesContent":["import OpenAI from \"openai\";\n\n// Initialize OpenAI client (will use env vars)\nconst openai = process.env.OPENAI_API_KEY\n  ? new OpenAI({\n      apiKey: process.env.OPENAI_API_KEY,\n    })\n  : null;\n\n// Check if API key is configured\nif (!process.env.OPENAI_API_KEY) {\n  console.warn(\n    \"⚠️  OPENAI_API_KEY not found in environment variables. AI features will use mock data.\"\n  );\n}\n\nexport interface AnalyzeResult {\n  companyName: string;\n  companyDescription: string;\n  mainServices: string[];\n  summary: string;\n  tone: string;\n  audience: string;\n  conceptSuggestions: Array<{\n    headline: string;\n    subheadline: string;\n    cta: string;\n    styleGuide: {\n      colors: string[];\n      font: string;\n      mood: string;\n    };\n  }>;\n  recommendedPrompt: string;\n}\n\nexport interface GenerateDesignResult {\n  imageUrl?: string;\n  htmlLayout?: string;\n  css?: string;\n  promptUsed: string;\n  thinkingSteps: Array<{\n    step: string;\n    timestamp: number;\n    content?: string;\n    code?: string;\n  }>;\n}\n\n/**\n * Analyze website content and generate banner concepts\n */\nexport async function analyzeWebsite(\n  content: string\n): Promise<AnalyzeResult> {\n  const prompt = `You are an expert marketing strategist and brand analyst. Carefully analyze this company website content in detail. Extract ALL key information including company name, what they do, their main services/products, and brand identity.\n\nWebsite content (read EVERY section carefully - company info, hero, about, sections by H2, paragraphs, key phrases, navigation, list items):\n${content.substring(0, 16000)}\n\nYour task - extract in DETAIL:\n1. COMPANY NAME: From title, OG title, logo alt, or main H1. Be exact.\n2. WHAT THE COMPANY DOES: From meta description, hero/intro, about section, and first paragraphs. Write 2-3 clear sentences covering industry, main business, and key value proposition.\n3. MAIN SERVICES/PRODUCTS: From navigation, list items, and section headings. List 4-6 specific offerings (not generic \"Services\").\n4. SUMMARY: A rich 4-6 sentence overview: who they are, what they do, who they serve, key differentiators or numbers (e.g. \"500+ engineers\"), and tone. Use concrete details from the content.\n5. TONE & AUDIENCE: Infer from wording and sections. Be specific (e.g. \"B2B enterprises in Asia\" not just \"businesses\").\n6. BANNER CONCEPTS: Headlines must include company name; subheadlines must reflect real services/value from the content.\n\nProvide a JSON response with:\n- companyName: Exact company name\n- companyDescription: 2-3 sentences (what they do, for whom, key strength)\n- mainServices: Array of 4-6 specific services/products from the site\n- summary: Detailed 4-6 sentence brand overview (use numbers, key phrases, differentiators from content)\n- tone: Brand voice (one or two words)\n- audience: Specific target (e.g. \"B2B enterprises\", \"SMB in Vietnam\")\n- conceptSuggestions: Array of 2-3 concepts with headline (company name + value), subheadline (specific services/value), cta, styleGuide (colors, font, mood)\n- recommendedPrompt: Detailed banner prompt with company name, real services, and style\n\nReturn ONLY valid JSON, no markdown formatting.`;\n\n  // Mock mode if no API key: parse content in detail for rich analysis\n  if (!openai) {\n    console.log(\"Using mock analysis (no API key) - extracting from website content\");\n    const companyNameMatch = content.match(/Company Name \\(from title\\):\\s*(.+?)(?:\\n|$)/i)\n      || content.match(/Page Title:\\s*(.+?)(?:\\s*[-|]\\s|$)/i)\n      || content.match(/OG Title:\\s*(.+?)(?:\\n|$)/i);\n    const companyName = companyNameMatch\n      ? companyNameMatch[1].trim().replace(/\\s*[-|].*$/, \"\").substring(0, 80)\n      : \"Company\";\n\n    const metaDesc = content.match(/Meta Description:\\s*(.+?)(?:\\n\\n|\\n===|$)/is);\n    const ogDesc = content.match(/OG Description:\\s*(.+?)(?:\\n\\n|\\n===|$)/is);\n    const companyDescription = (metaDesc?.[1]?.trim() || ogDesc?.[1]?.trim() || \"\").substring(0, 220)\n      || \"Professional services and solutions for your business.\";\n\n    const h1Match = content.match(/H1:\\s*(.+?)(?:\\n\\n|\\n===|$)/i);\n    const h1Text = h1Match ? h1Match[1].trim().split(\"|\").map((s: string) => s.trim()).filter(Boolean)[0] : \"\";\n\n    const heroMatch = content.match(/HERO \\/ INTRO TEXT ===\\s*\\n([\\s\\S]+?)(?:\\n\\n===|$)/i);\n    const heroText = heroMatch ? heroMatch[1].trim().substring(0, 300) : \"\";\n\n    const sectionsMatch = content.match(/CONTENT BY SECTIONS \\(H2\\) ===\\s*\\n([\\s\\S]+?)(?:\\n\\n===|$)/i);\n    const sectionsText = sectionsMatch ? sectionsMatch[1].trim().substring(0, 600) : \"\";\n\n    const navMatch = content.match(/NAVIGATION \\/ MENU \\/ SERVICES ===\\s*\\n([\\s\\S]+?)(?:\\n\\n===|$)/i);\n    const navStr = navMatch ? navMatch[1].trim() : \"\";\n    const mainServices = navStr\n      ? navStr.split(\"|\").map((s: string) => s.trim()).filter(s => s.length > 2 && s.length < 45).slice(0, 6)\n      : [];\n\n    const listMatch = content.match(/LIST ITEMS \\/ FEATURES ===\\s*\\n-?\\s*([\\s\\S]+?)(?:\\n\\n===|$)/i);\n    const listStr = listMatch ? listMatch[1].trim() : \"\";\n    const listItems = listStr.split(/\\n-/).map((s: string) => s.trim()).filter(s => s.length > 5 && s.length < 80).slice(0, 8);\n    if (listItems.length && mainServices.length < 3) mainServices.push(...listItems.slice(0, 4));\n    const services = mainServices.length ? mainServices.slice(0, 6) : (h1Text ? [h1Text] : [\"Services\", \"Solutions\", \"Consulting\"]);\n\n    const paragraphsMatch = content.match(/ALL PARAGRAPHS \\(main body\\) ===\\s*\\n([\\s\\S]+?)(?:\\n\\n===|$)/i);\n    const paraText = paragraphsMatch ? paragraphsMatch[1].trim().substring(0, 500) : \"\";\n    const summaryParts = [companyName, companyDescription, heroText || paraText, sectionsText].filter(Boolean);\n    const summary = summaryParts.join(\" \").substring(0, 520) + (summaryParts.join(\" \").length > 520 ? \"…\" : \"\");\n\n    return {\n      companyName: companyName || \"Company\",\n      companyDescription: companyDescription || \"Professional solutions\",\n      mainServices: services,\n      summary: summary || \"Company information extracted from website.\",\n      tone: \"professional\",\n      audience: \"Businesses and clients seeking quality services\",\n      conceptSuggestions: [\n        {\n          headline: `${companyName} — ${h1Text || \"Solutions\"}`,\n          subheadline: (companyDescription + (heroText ? \" \" + heroText.substring(0, 80) : \"\")).substring(0, 120),\n          cta: \"Contact Us\",\n          styleGuide: {\n            colors: [\"#1e3a5f\", \"#2563eb\", \"#0ea5e9\"],\n            font: \"Inter\",\n            mood: \"modern, confident, professional\",\n          },\n        },\n        {\n          headline: `${companyName}`,\n          subheadline: (h1Text || companyDescription).substring(0, 120),\n          cta: \"Learn More\",\n          styleGuide: {\n            colors: [\"#0f766e\", \"#0d9488\", \"#14b8a6\"],\n            font: \"Inter\",\n            mood: \"trustworthy, innovative\",\n          },\n        },\n      ],\n      recommendedPrompt: `Professional marketing banner for ${companyName}. Display company name prominently. Include: ${companyDescription.substring(0, 100)}. Services: ${services.slice(0, 4).join(\", \")}. Modern, clean design.`,\n    };\n  }\n\n  try {\n    const completion = await openai.chat.completions.create({\n      model: \"gpt-4o-mini\",\n      messages: [\n        {\n          role: \"system\",\n          content:\n            \"You are a marketing strategist. Return only valid JSON, no markdown or code blocks.\",\n        },\n        { role: \"user\", content: prompt },\n      ],\n      response_format: { type: \"json_object\" },\n      temperature: 0.7,\n    });\n\n    const result = JSON.parse(\n      completion.choices[0]?.message?.content || \"{}\"\n    ) as AnalyzeResult;\n\n    return result;\n  } catch (error) {\n    console.error(\"AI analysis error:\", error);\n    // Return fallback data\n    return {\n      summary: \"Brand analysis completed. Ready to generate banners.\",\n      tone: \"professional\",\n      audience: \"General audience\",\n      conceptSuggestions: [\n        {\n          headline: \"Transform Your Business\",\n          subheadline: \"Discover innovative solutions\",\n          cta: \"Get Started\",\n          styleGuide: {\n            colors: [\"#6366f1\", \"#8b5cf6\", \"#06b6d4\"],\n            font: \"Inter\",\n            mood: \"modern, confident\",\n          },\n        },\n      ],\n      recommendedPrompt:\n        \"Modern marketing banner with gradient background, professional typography, clean layout\",\n    };\n  }\n}\n\n/**\n * Generate banner image using AI\n */\nexport async function generateBannerImage(\n  prompt: string\n): Promise<{ imageUrl: string }> {\n  // Mock mode if no API key\n  if (!openai) {\n    console.log(\"Using mock image (no API key)\");\n    // Return a placeholder image URL\n    return {\n      imageUrl:\n        \"https://via.placeholder.com/1200x400/6366f1/ffffff?text=Mock+Banner+Preview%0A(Add+OPENAI_API_KEY+to+generate+real+images)\",\n    };\n  }\n\n  try {\n    console.log(\"Generating image with prompt:\", prompt);\n    const response = await openai.images.generate({\n      model: \"dall-e-3\",\n      prompt: `Marketing banner design: ${prompt}. Professional, high-quality, suitable for web advertising.`,\n      size: \"1024x1792\", // Portrait banner\n      quality: \"standard\",\n      n: 1,\n    });\n\n    console.log(\"DALL-E response:\", response);\n    const imageUrl = response.data[0]?.url || \"\";\n    console.log(\"Generated image URL:\", imageUrl);\n    \n    if (!imageUrl) {\n      throw new Error(\"No image URL returned from DALL-E\");\n    }\n    \n    return { imageUrl };\n  } catch (error) {\n    console.error(\"Image generation error:\", error);\n    if (error instanceof Error) {\n      throw new Error(`Failed to generate image: ${error.message}`);\n    }\n    throw new Error(\"Failed to generate image\");\n  }\n}\n\n/**\n * Parse color hints from user prompt (e.g. \"vàng đen\", \"yellow black\", \"đỏ\")\n */\nfunction parseColorsFromPrompt(prompt: string): string[] | null {\n  const p = prompt.toLowerCase();\n  const colorMap: Record<string, string[]> = {\n    \"vàng đen\": [\"#1a1a1a\", \"#2d2d2d\", \"#FACC15\"],\n    \"yellow black\": [\"#1a1a1a\", \"#2d2d2d\", \"#FACC15\"],\n    \"vàng và đen\": [\"#1a1a1a\", \"#FACC15\"],\n    \"đen vàng\": [\"#1a1a1a\", \"#262626\", \"#FACC15\"],\n    \"black yellow\": [\"#1a1a1a\", \"#262626\", \"#FACC15\"],\n    \"đỏ\": [\"#dc2626\", \"#b91c1c\", \"#f87171\"],\n    \"red\": [\"#dc2626\", \"#b91c1c\", \"#f87171\"],\n    \"xanh dương\": [\"#2563eb\", \"#1d4ed8\", \"#3b82f6\"],\n    \"blue\": [\"#2563eb\", \"#1d4ed8\", \"#3b82f6\"],\n    \"xanh lá\": [\"#16a34a\", \"#15803d\", \"#22c55e\"],\n    \"green\": [\"#16a34a\", \"#15803d\", \"#22c55e\"],\n    \"tím\": [\"#7c3aed\", \"#6d28d9\", \"#8b5cf6\"],\n    \"purple\": [\"#7c3aed\", \"#6d28d9\", \"#8b5cf6\"],\n    \"cam\": [\"#ea580c\", \"#c2410c\", \"#f97316\"],\n    \"orange\": [\"#ea580c\", \"#c2410c\", \"#f97316\"],\n  };\n  for (const [key, colors] of Object.entries(colorMap)) {\n    if (p.includes(key)) return colors;\n  }\n  if (/\\b(vàng|yellow)\\b/.test(p) && /\\b(đen|black)\\b/.test(p)) return [\"#1a1a1a\", \"#2d2d2d\", \"#FACC15\"];\n  return null;\n}\n\n/**\n * Generate HTML/CSS layout for banner\n */\nexport async function generateHtmlLayout(\n  prompt: string,\n  concept?: AnalyzeResult[\"conceptSuggestions\"][0],\n  companyInfo?: { companyName?: string; companyDescription?: string; mainServices?: string[] },\n  userModification?: string\n): Promise<{ html: string; css: string }> {\n  // Mock mode if no API key\n  if (!openai) {\n    console.log(\"Using mock HTML/CSS (no API key)\");\n    const companyName = companyInfo?.companyName || concept?.headline.split(/[-—]/)[0]?.trim() || \"Company Name\";\n    const headline = concept?.headline?.replace(companyName + \" - \", \"\")?.replace(companyName + \" — \", \"\")?.replace(companyName + \" \", \"\") || \"Solutions & Services\";\n    const subheadline = concept?.subheadline || companyInfo?.companyDescription || \"Discover innovative solutions for your business.\";\n    const servicesList = companyInfo?.mainServices?.slice(0, 4) || [];\n    const cta = concept?.cta || \"Get Started\";\n    // Apply user's color/modification from prompt (e.g. \"vàng đen\", \"yellow black\")\n    const promptColors = parseColorsFromPrompt(prompt);\n    const colors = promptColors || concept?.styleGuide.colors || [\"#1e3a5f\", \"#2563eb\", \"#0ea5e9\"];\n    const servicesHtml = servicesList.length\n      ? `<ul class=\"banner-services-list\">${servicesList.map((s: string) => `<li><span class=\"banner-service-pill\">${s}</span></li>`).join(\"\")}</ul>`\n      : \"\";\n\n    return {\n      html: `\n        <div class=\"banner\">\n          <div class=\"banner-bg-pattern\"></div>\n          <div class=\"banner-inner\">\n            <div class=\"banner-main\">\n              <div class=\"banner-badge\">Professional</div>\n              <h1 class=\"banner-company-name\">${companyName}</h1>\n              <p class=\"banner-tagline\">${headline}</p>\n              <p class=\"banner-description\">${subheadline}</p>\n              ${servicesHtml}\n              <div class=\"banner-cta-wrap\">\n                <button class=\"banner-cta primary\">${cta}</button>\n                <span class=\"banner-cta-secondary\">Learn more</span>\n              </div>\n            </div>\n            <div class=\"banner-side\">\n              <div class=\"banner-card\">\n                <div class=\"banner-card-value\">Trusted</div>\n                <div class=\"banner-card-label\">Partner</div>\n              </div>\n              <div class=\"banner-card\">\n                <div class=\"banner-card-value\">Quality</div>\n                <div class=\"banner-card-label\">Focus</div>\n              </div>\n            </div>\n          </div>\n        </div>\n      `,\n      css: `\n        .banner {\n          width: 1200px;\n          min-height: 480px;\n          background: linear-gradient(135deg, ${colors[0]} 0%, ${colors[1] || colors[0]} 50%, ${colors[2] || colors[1] || colors[0]} 100%);\n          border-radius: 16px;\n          box-shadow: 0 25px 80px rgba(0,0,0,0.25), 0 0 0 1px rgba(255,255,255,0.08);\n          position: relative;\n          overflow: hidden;\n          font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;\n        }\n        .banner-bg-pattern {\n          position: absolute;\n          inset: 0;\n          background: radial-gradient(ellipse 80% 50% at 100% 50%, rgba(255,255,255,0.12) 0%, transparent 50%),\n                      linear-gradient(180deg, transparent 0%, rgba(0,0,0,0.06) 100%);\n          pointer-events: none;\n        }\n        .banner-inner {\n          position: relative;\n          z-index: 1;\n          display: flex;\n          align-items: stretch;\n          justify-content: space-between;\n          padding: 48px 56px;\n          min-height: 480px;\n        }\n        .banner-main {\n          flex: 1;\n          max-width: 720px;\n          color: #fff;\n        }\n        .banner-badge {\n          display: inline-block;\n          font-size: 11px;\n          font-weight: 600;\n          letter-spacing: 0.12em;\n          text-transform: uppercase;\n          color: rgba(255,255,255,0.9);\n          background: rgba(255,255,255,0.18);\n          padding: 6px 14px;\n          border-radius: 100px;\n          margin-bottom: 20px;\n        }\n        .banner-company-name {\n          font-size: 42px;\n          font-weight: 700;\n          letter-spacing: -0.02em;\n          line-height: 1.15;\n          margin: 0 0 12px 0;\n          text-shadow: 0 2px 20px rgba(0,0,0,0.2);\n        }\n        .banner-tagline {\n          font-size: 22px;\n          font-weight: 600;\n          opacity: 0.95;\n          margin: 0 0 16px 0;\n          line-height: 1.35;\n        }\n        .banner-description {\n          font-size: 16px;\n          line-height: 1.6;\n          opacity: 0.9;\n          margin: 0 0 28px 0;\n          max-width: 540px;\n        }\n        .banner-services-list {\n          list-style: none;\n          margin: 0 0 32px 0;\n          padding: 0;\n          display: flex;\n          flex-wrap: wrap;\n          gap: 10px;\n        }\n        .banner-services-list li { margin: 0; padding: 0; }\n        .banner-service-pill {\n          display: inline-block;\n          font-size: 13px;\n          font-weight: 500;\n          color: rgba(255,255,255,0.95);\n          background: rgba(255,255,255,0.2);\n          padding: 8px 16px;\n          border-radius: 8px;\n          border: 1px solid rgba(255,255,255,0.25);\n        }\n        .banner-cta-wrap {\n          display: flex;\n          align-items: center;\n          gap: 20px;\n        }\n        .banner-cta {\n          border: none;\n          padding: 16px 32px;\n          font-size: 16px;\n          font-weight: 600;\n          border-radius: 10px;\n          cursor: pointer;\n          transition: transform 0.15s, box-shadow 0.2s;\n        }\n        .banner-cta.primary {\n          background: #fff;\n          color: ${colors[0]};\n          box-shadow: 0 4px 20px rgba(0,0,0,0.2);\n        }\n        .banner-cta.primary:hover {\n          transform: translateY(-2px);\n          box-shadow: 0 8px 28px rgba(0,0,0,0.25);\n        }\n        .banner-cta-secondary {\n          font-size: 14px;\n          font-weight: 500;\n          color: rgba(255,255,255,0.9);\n          text-decoration: underline;\n          text-underline-offset: 3px;\n          cursor: pointer;\n        }\n        .banner-side {\n          display: flex;\n          flex-direction: column;\n          justify-content: center;\n          gap: 16px;\n          margin-left: 40px;\n        }\n        .banner-card {\n          background: rgba(255,255,255,0.15);\n          backdrop-filter: blur(8px);\n          border: 1px solid rgba(255,255,255,0.25);\n          border-radius: 12px;\n          padding: 20px 28px;\n          min-width: 140px;\n          text-align: center;\n        }\n        .banner-card-value {\n          font-size: 20px;\n          font-weight: 700;\n          color: #fff;\n          margin-bottom: 4px;\n        }\n        .banner-card-label {\n          font-size: 12px;\n          font-weight: 500;\n          color: rgba(255,255,255,0.85);\n          text-transform: uppercase;\n          letter-spacing: 0.05em;\n        }\n      `,\n    };\n  }\n\n  const companyInfoText = companyInfo \n    ? `\\nCompany Name: ${companyInfo.companyName}\\nCompany Description: ${companyInfo.companyDescription}\\nMain Services: ${companyInfo.mainServices?.join(\", \")}`\n    : \"\";\n\n  const userRequestBlock = userModification && userModification.length > 0\n    ? `\\n\\n*** CRITICAL - USER MODIFICATION REQUEST (you MUST apply this): ***\\n\"${userModification}\"\\n*** Apply the above changes (colors, style, layout) to the banner. Then follow the requirements below. ***\\n\\n`\n    : \"\";\n\n  const layoutPrompt = `${userRequestBlock}You are an expert web designer. Create a RICH, PROFESSIONAL marketing banner (HTML + CSS) that looks like a high-end SaaS/corporate landing hero.\n\nREQUIRED ELEMENTS (include all):\n1. COMPANY NAME - large, bold (e.g. 38-44px), prominent at top\n2. SHORT TAGLINE or HEADLINE - under company name (e.g. 20-24px)\n3. DESCRIPTION - 1-2 sentences explaining what the company does (e.g. 15-17px, max-width for readability)\n4. SERVICES / KEY OFFERINGS - display as 3-5 pills or badges (e.g. \"Software Development\", \"Consulting\") in a row\n5. PRIMARY CTA BUTTON - main action (e.g. \"Contact Us\", \"Get Started\")\n6. OPTIONAL: small badge at top (e.g. \"Professional\" or \"Trusted Partner\") and/or 1-2 small value cards (e.g. \"Trusted Partner\", \"Quality Focus\") on the right side\n\nDesign requirements:\n- Size: 1200px width, min-height 480px (not 400px)\n- Layout: main content left (company name, tagline, description, services, CTA); optional cards or accent on right\n- Use gradient background with the provided colors; subtle overlay or pattern is fine\n- Professional typography: clear hierarchy, good line-height, text-shadow if needed for readability\n- Pills/badges for services: rounded, semi-transparent background, readable\n- One primary CTA button (white or contrasting), optional secondary text link\n- Rounded corners (12-16px), subtle shadow. No simple one-line layout.\n\nConcept details:\nPrompt: ${prompt}\n${concept ? `Headline: ${concept.headline}\\nSubheadline: ${concept.subheadline}\\nCTA: ${concept.cta}\\nColors: ${concept.styleGuide.colors.join(\", \")}\\nMood: ${concept.styleGuide.mood}` : \"\"}\n${companyInfoText}\n\nReturn a JSON object with:\n- html: Complete HTML (semantic: divs with classes like banner, banner-company-name, banner-tagline, banner-description, banner-services-list or banner-service-pill, banner-cta, etc.)\n- css: Full CSS for all classes (gradient, spacing, typography, pills, button, cards). Banner must be 1200px wide, min-height 480px.\n\nThe banner must look professional and information-rich: anyone should immediately see company name, what they do, and key services.\nReturn ONLY valid JSON, no markdown formatting.`;\n\n  try {\n    const completion = await openai.chat.completions.create({\n      model: \"gpt-4o-mini\",\n      messages: [\n        {\n          role: \"system\",\n          content:\n            \"You are a frontend developer. Return only valid JSON with 'html' and 'css' keys.\",\n        },\n        { role: \"user\", content: layoutPrompt },\n      ],\n      response_format: { type: \"json_object\" },\n      temperature: 0.8,\n    });\n\n    const result = JSON.parse(\n      completion.choices[0]?.message?.content || \"{}\"\n    ) as { html: string; css: string };\n\n    return {\n      html: result.html || \"<div>Banner HTML</div>\",\n      css: result.css || \"div { padding: 20px; }\",\n    };\n  } catch (error) {\n    console.error(\"HTML generation error:\", error);\n    return {\n      html: '<div class=\"banner\"><h1>Banner</h1></div>',\n      css: \".banner { padding: 20px; }\",\n    };\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 600, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ntq.L-AI-TUNV4/ai-banner-app/src/app/api/generate-design/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport {\n  generateBannerImage,\n  generateHtmlLayout,\n  type AnalyzeResult,\n} from \"@/lib/aiClient\";\n\n// Helper function to add delay (simulate thinking)\nconst delay = (ms: number) => new Promise(resolve => setTimeout(resolve, ms));\n\nexport async function POST(request: NextRequest) {\n  try {\n    const { urlInfo, concept, promptOverrides, mode = \"both\", companyInfo } =\n      await request.json();\n\n    if (!concept && !promptOverrides) {\n      return NextResponse.json(\n        { error: \"Concept or prompt is required\" },\n        { status: 400 }\n      );\n    }\n\n    const thinkingSteps: Array<{\n      step: string;\n      timestamp: number;\n      content?: string;\n      code?: string;\n    }> = [];\n\n    const startTime = Date.now();\n\n    // Step 1: Analyze requirements\n    thinkingSteps.push({\n      step: \"Analyzing banner requirements\",\n      timestamp: Date.now() - startTime,\n      content: \"Reading company information and concept details...\",\n    });\n    await delay(800); // Simulate thinking time\n\n    // Step 2: Build prompt\n    thinkingSteps.push({\n      step: \"Building generation prompt\",\n      timestamp: Date.now() - startTime,\n      content: \"Combining concept, company info, and user requirements...\",\n    });\n    await delay(600);\n\n    let finalPrompt: string;\n    if (concept) {\n      finalPrompt = `Marketing banner: ${concept.headline}. ${concept.subheadline}. Style: ${concept.styleGuide.mood}. Colors: ${concept.styleGuide.colors.join(\", \")}. CTA: ${concept.cta}`;\n    } else {\n      finalPrompt = promptOverrides || \"\";\n    }\n\n    if (promptOverrides && concept) {\n      finalPrompt = `${finalPrompt}. Additional requirements: ${promptOverrides}`;\n    }\n\n    thinkingSteps.push({\n      step: \"Prompt finalized\",\n      timestamp: Date.now() - startTime,\n      content: finalPrompt,\n    });\n\n    const result: {\n      imageUrl?: string;\n      htmlLayout?: string;\n      css?: string;\n      promptUsed: string;\n      thinkingSteps: typeof thinkingSteps;\n    } = {\n      promptUsed: finalPrompt,\n      thinkingSteps,\n    };\n\n    // Step 3: Generate HTML/CSS (prioritize this - it's faster and more reliable)\n    if (mode === \"code\" || mode === \"both\") {\n      thinkingSteps.push({\n        step: \"Designing banner layout\",\n        timestamp: Date.now() - startTime,\n        content: \"Planning banner structure: company name, services, CTA placement...\",\n      });\n      await delay(1000);\n\n      thinkingSteps.push({\n        step: \"Generating HTML structure\",\n        timestamp: Date.now() - startTime,\n        content: \"Creating semantic HTML with company name, headline, and call-to-action...\",\n      });\n      await delay(800);\n\n      try {\n        const htmlResult = await generateHtmlLayout(\n          finalPrompt,\n          concept as AnalyzeResult[\"conceptSuggestions\"][0] | undefined,\n          companyInfo\n        );\n        result.htmlLayout = htmlResult.html;\n        result.css = htmlResult.css;\n\n        thinkingSteps.push({\n          step: \"HTML structure created\",\n          timestamp: Date.now() - startTime,\n          content: \"HTML markup generated with company information\",\n          code: htmlResult.html.substring(0, 300) + \"...\",\n        });\n        await delay(500);\n\n        thinkingSteps.push({\n          step: \"Applying CSS styles\",\n          timestamp: Date.now() - startTime,\n          content: \"Styling banner with gradients, typography, and modern design...\",\n        });\n        await delay(700);\n\n        thinkingSteps.push({\n          step: \"HTML/CSS generation complete\",\n          timestamp: Date.now() - startTime,\n          content: \"Banner code ready for preview\",\n          code: `HTML:\\n${htmlResult.html.substring(0, 250)}...\\n\\nCSS:\\n${htmlResult.css.substring(0, 250)}...`,\n        });\n      } catch (error) {\n        thinkingSteps.push({\n          step: \"HTML/CSS generation failed\",\n          timestamp: Date.now() - startTime,\n          content: `Error: ${error instanceof Error ? error.message : \"Unknown error\"}`,\n        });\n      }\n    }\n\n    // Step 4: Generate image (optional, can be slow)\n    if (mode === \"image\" || mode === \"both\") {\n      thinkingSteps.push({\n        step: \"Preparing image generation\",\n        timestamp: Date.now() - startTime,\n        content: \"Setting up image generation with DALL-E...\",\n      });\n      await delay(600);\n\n      thinkingSteps.push({\n        step: \"Calling image generation API\",\n        timestamp: Date.now() - startTime,\n        content: \"Generating banner image with DALL-E (this may take 10-20 seconds)...\",\n      });\n\n      try {\n        const imageResult = await generateBannerImage(finalPrompt);\n        if (imageResult.imageUrl) {\n          result.imageUrl = imageResult.imageUrl;\n          thinkingSteps.push({\n            step: \"Image generated successfully\",\n            timestamp: Date.now() - startTime,\n            content: `Image URL received: ${imageResult.imageUrl.substring(0, 60)}...`,\n          });\n        } else {\n          thinkingSteps.push({\n            step: \"Image generation returned no URL\",\n            timestamp: Date.now() - startTime,\n            content: \"DALL-E API returned empty image URL\",\n          });\n        }\n      } catch (error) {\n        console.error(\"Image generation error in API:\", error);\n        thinkingSteps.push({\n          step: \"Image generation failed\",\n          timestamp: Date.now() - startTime,\n          content: `Error: ${error instanceof Error ? error.message : \"Unknown error\"}. HTML/CSS banner is still available.`,\n        });\n      }\n    }\n\n    thinkingSteps.push({\n      step: \"Generation complete\",\n      timestamp: Date.now() - startTime,\n      content: result.imageUrl \n        ? \"Banner image and code ready for preview\" \n        : result.htmlLayout \n        ? \"HTML/CSS code ready (image generation skipped or failed)\"\n        : \"Generation completed but no output available\",\n    });\n\n    console.log(\"Final result:\", {\n      hasImageUrl: !!result.imageUrl,\n      hasHtmlLayout: !!result.htmlLayout,\n      hasCss: !!result.css,\n      imageUrl: result.imageUrl?.substring(0, 80),\n    });\n\n    return NextResponse.json(result);\n  } catch (error) {\n    console.error(\"Generate design error:\", error);\n    return NextResponse.json(\n      { error: \"Internal server error\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":"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"}}]
}